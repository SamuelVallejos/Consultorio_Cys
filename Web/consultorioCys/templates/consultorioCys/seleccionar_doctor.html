{% extends 'base_generic.html' %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Seleccionar Doctor</h2>

    <!-- Mostrar mensaje de error si existe -->
    {% if error_message %}
        <div class="alert alert-danger" role="alert">
            {{ error_message }}
        </div>
    {% else %}
        <p class="text-center">Especialidad: <strong>{{ especialidad }}</strong> | Fecha: <strong>{{ fecha }}</strong></p>
        
        <!-- Lista de doctores disponibles -->
        <div class="list-group">
            {% for doctor in doctores %}
                <div class="list-group-item">
                    <h5>{{ doctor.nombre }} {{ doctor.apellido }}</h5>
                    <p>Especialidad: {{ doctor.especialidad_doctor }}</p>
                    <p>Ubicación: {{ doctor.doctorclinica_set.first.sedeclinica.clinica.nombre_clinica }} - {{ doctor.doctorclinica_set.first.sedeclinica.comuna_sede }}, {{ doctor.doctorclinica_set.first.sedeclinica.region_sede }}</p>
                    
                    <!-- Botón para seleccionar este doctor -->
                    <form method="post" action="{% url 'confirmacion_cita' %}">
                        {% csrf_token %}
                        <input type="hidden" name="doctor_id" value="{{ doctor.id }}">
                        <input type="hidden" name="fecha" value="{{ fecha }}">
                        <button type="submit" class="btn btn-primary mt-2">Seleccionar este Doctor</button>
                    </form>
                </div>
            {% empty %}
                <p>No hay doctores disponibles para la especialidad y sede seleccionadas.</p>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endblock %}

{% extends 'base_generic.html' %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Doctores en {{ sede.clinica.nombre_clinica }} - {{ sede.comuna_sede }}, {{ sede.region_sede }}</h2>
    <h3 class="text-center mb-4">Especialidad: {{ especialidad }}</h3>

    {% if doctores %}
        <div class="doctor-list">
            {% for doctor in doctores %}
            <div class="doctor-card">
                <h5>{{ doctor.nombres_doctor }} {{ doctor.primer_apellido_doctor }}</h5>
                <p>Especialidad: {{ doctor.especialidad_doctor }}</p>
                <small>Contacto: {{ doctor.correo_doctor }} | Tel: {{ doctor.telefono_doctor }}</small>
                
                <!-- BotÃ³n para expandir/cerrar horas -->
                <button class="toggle-hours-btn" onclick="toggleHours('hours-{{ doctor.id }}')">
                    Mostrar horas
                </button>

                <!-- Contenedor de horas (expandible) -->
                <div id="hours-{{ doctor.id }}" class="hours-container" style="display: none;">
                    <p>Horas disponibles:</p>
                    <div class="appointment-times">
                        {% for hora in doctor.horarios_disponibles %}
                            <button class="time-slot">{{ hora }}</button>
                        {% endfor %}
                    </div>
                </div>

                <form method="post" action="{% url 'seleccionar_doctor' %}">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <input type="hidden" name="doctor_id" value="{{ doctor.id }}">
                    <button type="submit" class="btn btn-primary">Agendar Cita</button>
                </form>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-center">No se encontraron doctores para esta especialidad y sede.</p>
    {% endif %}
</div>

<script>
    function toggleHours(id) {
        var hoursContainer = document.getElementById(id);
        if (hoursContainer.style.display === "none") {
            hoursContainer.style.display = "block";
        } else {
            hoursContainer.style.display = "none";
        }
    }
</script>

{% endblock %}
